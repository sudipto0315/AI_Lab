import random
import math

no_of_students = 10
no_of_groups = 3
calculated_diversity_call_count = 1
marks = [random.randint(50, 100) for _ in range(no_of_students)]  # Add this line to generate random marks for each student

def calculate_diversity(groups):
    diversity = 0
    for group in groups:
        group_avg = sum(marks[student] for student in group) / (len(group) + 1)  # Modify this line to use the marks of the students
        for student in group:
            diversity += abs(marks[student] - group_avg)  # Modify this line to use the marks of the students
    return diversity

def get_random_groups():
    groups = []
    for i in range(no_of_groups):
        groups.append([])
    for student in range(no_of_students):
        groups[random.randint(0, no_of_groups - 1)].append(student)
    print("The groups generated by the get_random_groups function are: ")
    print(groups)
    return groups


def get_neighbour_groups(groups):
    new_groups = []
    for i in range(no_of_groups):
        new_groups.append([])
    for group in groups:
        for student in group:
            new_groups[random.randint(0, no_of_groups - 1)].append(student)
    return new_groups


def get_probability(old_diversity, new_diversity, temperature):
    return math.exp((old_diversity - new_diversity) / temperature)


def stochastic_hill_climbing():
    groups = get_random_groups()
    old_diversity = calculate_diversity(groups)
    temperature = 1
    while temperature > 0.0001:
        new_groups = get_neighbour_groups(groups)
        new_diversity = calculate_diversity(new_groups)
        if new_diversity < old_diversity:
            groups = new_groups
            old_diversity = new_diversity
        else:
            probability = get_probability(old_diversity, new_diversity, temperature)
            if random.random() < probability:
                groups = new_groups
                old_diversity = new_diversity
        temperature *= 0.9
    return groups


groups = stochastic_hill_climbing()

print("The final groups are: ")
for i, group in enumerate(groups):
    print(f"Group {i+1}: {group}, Marks: {[marks[student] for student in group]}")  # Modify this line to also print the marks of the students in each group

print("\nThe diversity of the final groups is: ")
print(calculate_diversity(groups))